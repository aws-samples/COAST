{
  "__inputs": [
    {
      "name": "DS_COAST-2023-09-19",
      "label": "COAST-2023-09-19",
      "description": "",
      "type": "datasource",
      "pluginId": "grafana-athena-datasource",
      "pluginName": "Amazon Athena"
    },
    {
      "name": "DS_CLOUDWATCH",
      "label": "Cloudwatch",
      "description": "",
      "type": "datasource",
      "pluginId": "cloudwatch",
      "pluginName": "CloudWatch"
    }
  ],
  "__elements": {},
  "__requires": [
    {
      "type": "panel",
      "id": "annolist",
      "name": "Annotations list",
      "version": ""
    },
    {
      "type": "panel",
      "id": "barchart",
      "name": "Bar chart",
      "version": ""
    },
    {
      "type": "datasource",
      "id": "cloudwatch",
      "name": "CloudWatch",
      "version": "1.0.0"
    },
    {
      "type": "grafana",
      "id": "grafana",
      "name": "Grafana",
      "version": "9.4.7"
    },
    {
      "type": "datasource",
      "id": "grafana-athena-datasource",
      "name": "Amazon Athena",
      "version": "2.13.6"
    },
    {
      "type": "panel",
      "id": "stat",
      "name": "Stat",
      "version": ""
    },
    {
      "type": "panel",
      "id": "table",
      "name": "Table",
      "version": ""
    },
    {
      "type": "panel",
      "id": "text",
      "name": "Text",
      "version": ""
    },
    {
      "type": "panel",
      "id": "timeseries",
      "name": "Time series",
      "version": ""
    }
  ],
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "target": {
          "limit": 100,
          "matchAny": false,
          "tags": [],
          "type": "dashboard"
        },
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [
    {
      "asDropdown": false,
      "icon": "doc",
      "includeVars": false,
      "keepTime": false,
      "tags": [],
      "targetBlank": true,
      "title": "Cloudwatch Documentation",
      "tooltip": "Cloudwatch Documenatation",
      "type": "link",
      "url": "https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/working_with_metrics.html"
    }
  ],
  "liveNow": false,
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 13,
      "panels": [],
      "title": "Instructions",
      "type": "row"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_COAST-2023-09-19}"
      },
      "description": "",
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 0,
        "y": 1
      },
      "id": 15,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "<span style='color: #AF69EE;font-size:20px'>Auto Scaling Dashboard</span>\n<p>\nCOAST is a collection of customizable Amazon Managed Grafana\ndashboards, offering both a high-level overview and detailed\nservice-specific insights based on the AWS Cost and Usage Report (CUR).\nDashboards cater to executive leadership, FinOps Practitioners, and DevOps/Engineering.\n</p><p>\nThe <span style='color: #AF69EE'>Auto Scaling Dashboard</span> is designed for specific workloads, leveraging <span style='color: #FF9900'>CloudWatch</span> metrics and <span style='color: #FF9900'>Cost and Usage Report (CUR)</span> data to present comprehensive visualizations. It includes vital components such as Auto Scaling Groups (ASG), Load Balancers, NAT Gateways, and EC2 Instances that operate within the ASG.\n</p><p>\nFor any inquiries or further assistance in interpreting the data or utilizing the dashboard's features, please contact your assigned Cloud Financial Analyst or FinOps Manager for guidance and support.\n</p>\n",
        "mode": "html"
      },
      "pluginVersion": "9.4.7",
      "targets": [
        {
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "refId": "A"
        }
      ],
      "title": " ",
      "type": "text"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_COAST-2023-09-19}"
      },
      "description": "",
      "gridPos": {
        "h": 9,
        "w": 12,
        "x": 12,
        "y": 1
      },
      "id": 17,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "<div style='font-size: 18px'>\nHow to Utilize this Dashboard\n</div>\nFor additional instructions see the <a href=\"https://github.com/aws-samples/coast-grafana-cost-intelligence-dashboards/tree/main/grafana_dashboards/auto_scaling\" target=\"_blank\">Github Readme file</a>.<br><br>\n\nTo make the most of the <span style='color: #AF69EE'>Autoscaling Dashboard</span>, input the following parameters in the top parameter menu:\n<br><br>\n\n<ol>\n<li>Region: Select your region (note in the beta version of this dashboard only us-east-1 is supported).</li>\n\n<li>ASG Name: Fill in the name of your Auto Scaling Group (ASG).  The name is available on the ASG details page under \"Group Details\".</li>\n\n<li>Tags: Select the tag key for your resources.  The tag values will populate once the tag key is selected. The values for this drop down come from CUR with a lookback period of 3 days.</li>\n\n<li>Load Balancers: This drop down is populated automtically once you select your tag.  The values for this drop down come from CUR with a lookback period of 3 days.</li>\n\n<li>Nat Gateways: This drop down is populated automtically once you select your tag.  The values for this drop down come from CUR with a lookback period of 3 days.</li>\n\n<li>Granularity: This value is used only in CUR querys to smooth out data based on month, week, day or hour.  To match Cloudwatch, select hour.</li>\n</ol>\n",
        "mode": "html"
      },
      "pluginVersion": "9.4.7",
      "targets": [
        {
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "refId": "A"
        }
      ],
      "title": " ",
      "type": "text"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_COAST-2023-09-19}"
      },
      "description": "",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 10
      },
      "id": 60,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "The <span style='color: #AF69EE'>Required Columns Validator</span> evaluates your CUR dataset to confirm the presence of essential columns. For the dashboard to operate accurately, the CUR dataset must include columns for:\n<br><br>\n<ul>\n  <li>Resource IDs - </li>Resource IDs rows in CUR help deep dive cost at the resource ARNs layer.  To setup your CUR with resource IDs see <a href=\"https://docs.aws.amazon.com/cur/latest/userguide/cur-create.html\">Creating Cost and Usage Report</a>\n  <li>Cost Allocation Tags - Defining a cost allocation tag results in its persistence in your CUR dataset. For our queries to function correctly, it is imperative to have at least one cost allocation tag enabled.  See <a href=\"https://docs.aws.amazon.com/awsaccountbilling/latest/aboutv2/cost-alloc-tags.html\">Using Cost Allocation Tags</a>\n</ul>\n<br>\n<span style='color: #AF69EE'>VERIFIED</span> indicates the presence of the columns in your CUR. <span style='color: red'>FAILED</span> indicates the absence of these columns, and as a result, certain visuals in the dashboard may not function as expected.  If this is a new CUR it may take 24 hours for column data to populate.",
        "mode": "html"
      },
      "pluginVersion": "9.4.7",
      "targets": [
        {
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "refId": "A"
        }
      ],
      "title": " ",
      "type": "text"
    },
    {
      "datasource": {
        "type": "grafana-athena-datasource",
        "uid": "${DS_COAST-2023-09-19}"
      },
      "description": "This table will display TRUE if the required savings plans, reservation and cost allocation columns exist within your dataset.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "auto",
            "cellOptions": {
              "type": "color-text"
            },
            "inspect": false
          },
          "mappings": [
            {
              "options": {
                "FAILED": {
                  "color": "semi-dark-red",
                  "index": 1
                },
                "VERIFIED": {
                  "color": "semi-dark-purple",
                  "index": 0
                }
              },
              "type": "value"
            }
          ],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 10
      },
      "id": 59,
      "options": {
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true
      },
      "pluginVersion": "9.4.7",
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "format": 1,
          "rawSQL": "with user_tag_columns as ( -- count cost allocation tags\nSELECT \nCOUNT(*) OVER (PARTITION BY column_name) AS user_tag_column_count\nFROM information_schema.columns\nWHERE \ntable_name = '$CurTable'\nAND column_name LIKE 'resource_tags_user_%'  \n),\n\nresource_columns_query as ( -- check for savings plans column\nSELECT \nCOUNT(*) OVER (PARTITION BY column_name) AS resource_column_count\nFROM information_schema.columns\nWHERE \ntable_name = '$CurTable'\nAND column_name = 'line_item_resource_id'  \n)\n\nSELECT \nCASE\n    WHEN (SELECT SUM(user_tag_column_count) FROM user_tag_columns) > 0 THEN 'VERIFIED' ELSE 'FAILED' \nEND AS cost_allocation_tags,\nCASE \n    WHEN (SELECT SUM(resource_column_count) FROM resource_columns_query) > 0 THEN 'VERIFIED' ELSE 'FAILED' \nEND AS resource_id_columns",
          "refId": "A"
        }
      ],
      "title": "CUR Columns Validator",
      "type": "table"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 18
      },
      "id": 28,
      "panels": [
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "description": "",
          "gridPos": {
            "h": 2,
            "w": 24,
            "x": 0,
            "y": 2
          },
          "id": 35,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "The period over period analysis tabs will showcase cost for the selected date and time period _N_ , for N-1 period and calculate delta as a percentage.  For example if you today is Friday and you select \"Last 2 Days\" in the time period the widgets will display Friday and Thursday for the \"Selcted Time Period\".  Data for Wednesday and Tuesday for the \"Prior Time Period\" and calculate the percantage change between the two periods.  If you do not have data or tags as far bag as the prior time period, the widget will display a 0. ",
            "mode": "markdown"
          },
          "pluginVersion": "9.4.7",
          "targets": [
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "A",
              "region": "$Regions",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "type": "text"
        },
        {
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "noValue": "0",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "#5d5d5d",
                    "value": 0.1
                  }
                ]
              },
              "unit": "percentunit"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Selected Time Period"
                },
                "properties": [
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Prior Time Period"
                },
                "properties": [
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Percent"
                },
                "properties": [
                  {
                    "id": "thresholds",
                    "value": {
                      "mode": "absolute",
                      "steps": [
                        {
                          "color": "super-light-green"
                        },
                        {
                          "color": "red",
                          "value": 1
                        }
                      ]
                    }
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 0,
            "y": 4
          },
          "id": 30,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "textMode": "auto"
          },
          "pluginVersion": "9.4.7",
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nWITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  '$Granularity', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type Like '%Usage%'\nGROUP BY\n1\nLIMIT 1\n)\n  \nSELECT\n(SELECT period_one_cost FROM CURRENT_PERIOD_COST) as Cost\nFROM \n$CurTable\nLIMIT 1",
              "refId": "Selected Time Period"
            },
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\n\nWITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type Like '%Usage%'\n  AND resource_tags_user_$TagKey IN ($TagValue)\nGROUP BY\n1\nLIMIT 1\n)\n  \nSELECT\n  SUM(line_item_unblended_cost) as Cost\nFROM \n  $CurTable\nWHERE\n  line_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM CURRENT_PERIOD_COST) * INTERVAL '1' HOUR\n  AND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type Like '%Usage%'\n  AND resource_tags_user_$TagKey IN ($TagValue)",
              "refId": "Prior Time Period"
            },
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nWITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type Like '%Usage%'\n  AND resource_tags_user_$TagKey IN ($TagValue)\nGROUP BY\n1\nLIMIT 1\n)\n  \nSELECT\n  ((SELECT period_one_cost FROM CURRENT_PERIOD_COST) - SUM(line_item_unblended_cost)) / (SUM(line_item_unblended_cost)) as Change\nFROM \n  $CurTable\nWHERE\n  line_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM CURRENT_PERIOD_COST) * INTERVAL '1' HOUR\n  AND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type Like '%Usage%'\n  AND resource_tags_user_$TagKey IN ($TagValue)\nLIMIT 1;\n",
              "refId": "Percent"
            }
          ],
          "title": "Compute - Period over Period Analysis",
          "type": "stat"
        },
        {
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "noValue": "0",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "#5d5d5d",
                    "value": 0.1
                  }
                ]
              },
              "unit": "percentunit"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Selected Time Period"
                },
                "properties": [
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Prior Time Period"
                },
                "properties": [
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Percent"
                },
                "properties": [
                  {
                    "id": "thresholds",
                    "value": {
                      "mode": "percentage",
                      "steps": [
                        {
                          "color": "super-light-green"
                        },
                        {
                          "color": "red",
                          "value": 1
                        }
                      ]
                    }
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 6,
            "y": 4
          },
          "id": 31,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "textMode": "auto"
          },
          "pluginVersion": "9.4.7",
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nWITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  '$Granularity', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AWSELB'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type = 'LoadBalancerUsage' \n  AND line_item_operation LIKE '%LoadBalancing%'\nGROUP BY\n1\nLIMIT 1\n)\n  \nSELECT\n  (SELECT period_one_cost FROM CURRENT_PERIOD_COST) as Cost\nFROM \n  $CurTable\nLIMIT 1",
              "refId": "Selected Time Period"
            },
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "WITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AWSELB'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type = 'LoadBalancerUsage' \n  AND line_item_operation LIKE '%LoadBalancing%'\nGROUP BY\n1\nLIMIT 1\n)\n  \nSELECT\n  SUM(line_item_unblended_cost) as Cost\nFROM \n  $CurTable\nWHERE\n  line_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM CURRENT_PERIOD_COST) * INTERVAL '1' HOUR\n  AND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\n  AND line_item_product_code = 'AWSELB'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type = 'LoadBalancerUsage' \n  AND line_item_operation LIKE '%LoadBalancing%'",
              "refId": "Prior Time Period"
            },
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "rawSQL": "WITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AWSELB'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type = 'LoadBalancerUsage' \n  AND line_item_operation LIKE '%LoadBalancing%'\nLIMIT 1\n)\n  \nSELECT\n  ((SELECT period_one_cost FROM CURRENT_PERIOD_COST) - SUM(line_item_unblended_cost)) / (SUM(line_item_unblended_cost)) as Change\nFROM \n  $CurTable\nWHERE\n  line_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM CURRENT_PERIOD_COST) * INTERVAL '1' HOUR\n  AND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\n  AND line_item_product_code = 'AWSELB'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type = 'LoadBalancerUsage' \n  AND line_item_operation LIKE '%LoadBalancing%'\nLIMIT 1;\n",
              "refId": "Percent"
            }
          ],
          "title": "Load Balancer - Period over Period Analysis",
          "type": "stat"
        },
        {
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "noValue": "0",
              "thresholds": {
                "mode": "percentage",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "#5d5d5d",
                    "value": 1
                  }
                ]
              },
              "unit": "percentunit"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Selected Time Period"
                },
                "properties": [
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Prior Time Period"
                },
                "properties": [
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Percent"
                },
                "properties": [
                  {
                    "id": "thresholds",
                    "value": {
                      "mode": "percentage",
                      "steps": [
                        {
                          "color": "super-light-green"
                        },
                        {
                          "color": "red",
                          "value": 0
                        }
                      ]
                    }
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 12,
            "y": 4
          },
          "id": 32,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "textMode": "auto"
          },
          "pluginVersion": "9.4.7",
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nWITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  '$Granularity', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND (line_item_product_code = 'AWSELB' OR line_item_product_code = 'AmazonEC2')\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND (line_item_usage_type LIKE '%-Bytes' OR line_item_usage_type = 'LCUUsage' OR line_item_usage_type = 'NLCUUsage')\nGROUP BY\n1\nLIMIT 1\n)\n  \nSELECT\n  (SELECT period_one_cost FROM CURRENT_PERIOD_COST) as Cost\nFROM \n  $CurTable\nLIMIT 1",
              "refId": "Selected Time Period"
            },
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nWITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND (line_item_product_code = 'AWSELB' OR line_item_product_code = 'AmazonEC2')\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND (line_item_usage_type LIKE '%-Bytes' OR line_item_usage_type = 'LCUUsage' OR line_item_usage_type = 'NLCUUsage')\nGROUP BY\n1\nLIMIT 1\n)\n  \nSELECT\n  SUM(line_item_unblended_cost) as Cost\nFROM \n  $CurTable\nWHERE\n  line_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM CURRENT_PERIOD_COST) * INTERVAL '1' HOUR\n  AND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\n  AND (line_item_product_code = 'AWSELB' OR line_item_product_code = 'AmazonEC2')\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND (line_item_usage_type LIKE '%-Bytes' OR line_item_usage_type = 'LCUUsage' OR line_item_usage_type = 'NLCUUsage')",
              "refId": "Prior Time Period"
            },
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nWITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND (line_item_product_code = 'AWSELB' OR line_item_product_code = 'AmazonEC2')\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND (line_item_usage_type LIKE '%-Bytes' OR line_item_usage_type = 'LCUUsage' OR line_item_usage_type = 'NLCUUsage')\nLIMIT 1\n)\n  \nSELECT\n  ((SELECT period_one_cost FROM CURRENT_PERIOD_COST) - SUM(line_item_unblended_cost)) / (SUM(line_item_unblended_cost)) as Change\nFROM \n  $CurTable\nWHERE\n  line_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM CURRENT_PERIOD_COST) * INTERVAL '1' HOUR\n  AND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\n  AND (line_item_product_code = 'AWSELB' OR line_item_product_code = 'AmazonEC2')\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND (line_item_usage_type LIKE '%-Bytes' OR line_item_usage_type = 'LCUUsage' OR line_item_usage_type = 'NLCUUsage')\nLIMIT 1;\n",
              "refId": "Percent"
            }
          ],
          "title": "Network - Period over Period Analysis",
          "type": "stat"
        },
        {
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "thresholds"
              },
              "mappings": [],
              "noValue": "0",
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "#5d5d5d",
                    "value": 0.1
                  }
                ]
              },
              "unit": "percentunit"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Selected Time Period"
                },
                "properties": [
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Prior Time Period"
                },
                "properties": [
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  }
                ]
              },
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "Percent"
                },
                "properties": [
                  {
                    "id": "thresholds",
                    "value": {
                      "mode": "percentage",
                      "steps": [
                        {
                          "color": "super-light-green"
                        },
                        {
                          "color": "red",
                          "value": 1
                        }
                      ]
                    }
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 5,
            "w": 6,
            "x": 18,
            "y": 4
          },
          "id": 33,
          "options": {
            "colorMode": "value",
            "graphMode": "area",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
              "calcs": [
                "lastNotNull"
              ],
              "fields": "",
              "values": false
            },
            "textMode": "auto"
          },
          "pluginVersion": "9.4.7",
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nWITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  '$Granularity', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type LIKE 'NatGateway-Hours'\n  AND line_item_operation = 'NatGateway'\nGROUP BY\n1\nLIMIT 1\n)\n  \nSELECT\n  (SELECT period_one_cost FROM CURRENT_PERIOD_COST) as Cost\nFROM \n  $CurTable\nLIMIT 1",
              "refId": "Selected Time Period"
            },
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "WITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type LIKE 'NatGateway-Hours'\n  AND line_item_operation = 'NatGateway'\nGROUP BY\n1\nLIMIT 1\n)\n  \nSELECT\n  SUM(line_item_unblended_cost) as Cost\nFROM \n  $CurTable\nWHERE\n  line_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM CURRENT_PERIOD_COST) * INTERVAL '1' HOUR\n  AND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type LIKE 'NatGateway-Hours'\n  AND line_item_operation = 'NatGateway'",
              "refId": "Prior Time Period"
            },
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "rawSQL": "WITH CURRENT_PERIOD_COST AS (\nSELECT\ndate_diff(\n  'hour', \n  $__timeFrom(line_item_usage_start_date),  \n  $__timeTo(line_item_usage_start_date)\n) as HOURS,\nSUM(line_item_unblended_cost) as period_one_cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type LIKE 'NatGateway-Hours'\n  AND line_item_operation = 'NatGateway'\nLIMIT 1\n)\n  \nSELECT\n(SELECT period_one_cost FROM CURRENT_PERIOD_COST) / (SUM(line_item_unblended_cost)) - 1 as Change\nFROM \n$CurTable\nWHERE\nline_item_usage_start_date >= $__timeFrom(line_item_usage_start_date) - (SELECT HOURS FROM CURRENT_PERIOD_COST) * INTERVAL '1' HOUR\nAND line_item_usage_start_date <= $__timeFrom(line_item_usage_start_date)\nAND line_item_product_code = 'AmazonEC2'\nAND resource_tags_user_$TagKey IN ($TagValue)\nAND line_item_usage_type LIKE 'NatGateway-Hours'\nAND line_item_operation = 'NatGateway'\nLIMIT 1;\n",
              "refId": "Percent"
            }
          ],
          "title": "NAT Gateway - Period over Period Analysis",
          "type": "stat"
        },
        {
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "description": "Compute  Cost - Cost of compute for all instances in ASG\nLoadbalance Cost - Cost for Load Balancer and LCUUsage\nNetworking Cost - Cost for instance traffic, NAT Gateway Traffic and Load Balancer Traffic\nNatgateway Cost - Hourly Charge for NAT Gateway",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "palette-classic"
              },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 0,
                "gradientMode": "none",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineInterpolation": "smooth",
                "lineStyle": {
                  "dash": [
                    0,
                    10
                  ],
                  "fill": "dot"
                },
                "lineWidth": 1,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "always",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              }
            },
            "overrides": []
          },
          "gridPos": {
            "h": 8,
            "w": 24,
            "x": 0,
            "y": 9
          },
          "id": 26,
          "options": {
            "legend": {
              "calcs": [
                "max"
              ],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "multi",
              "sort": "desc"
            }
          },
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$Granularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as Cost\nFROM\n$CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type LIke '%Usage%'\n  AND line_item_operation = 'RunInstances'\nGROUP BY \n  1\nHAVING SUM(line_item_unblended_cost) > 0",
              "refId": "Compute"
            },
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$Granularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as Cost\nFROM\n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AWSELB'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type = 'LoadBalancerUsage' \n  AND line_item_operation LIKE '%LoadBalancing%'\nGROUP BY \n  1\nHAVING SUM(line_item_unblended_cost) > 0",
              "refId": "LoadBalancer"
            },
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \ndate_trunc('$Granularity', line_item_usage_start_date),\nSUM(line_item_unblended_cost) as Cost\nFROM\n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND (line_item_product_code = 'AWSELB' OR line_item_product_code = 'AmazonEC2')\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND (line_item_usage_type LIKE '%-Bytes' OR line_item_usage_type = 'LCUUsage' OR line_item_usage_type = 'NLCUUsage')\nGROUP BY \n  1\nHAVING SUM(line_item_unblended_cost) > 0",
              "refId": "Networking"
            },
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$Granularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as Cost\nFROM\n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type LIKE 'NatGateway-Hours'\n  AND line_item_operation = 'NatGateway'\nGROUP BY \n  1\nHAVING SUM(line_item_unblended_cost) > 0",
              "refId": "NatGateway"
            }
          ],
          "title": "Service Cost Trends",
          "transparent": true,
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-RdYlGr"
              },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "fillOpacity": 30,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineWidth": 2,
                "scaleDistribution": {
                  "type": "linear"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "currencyUSD"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "CUR AZ Query"
                },
                "properties": [
                  {
                    "id": "custom.axisLabel",
                    "value": "Availability Zone Cost"
                  },
                  {
                    "id": "displayName",
                    "value": "Availability Zone Cost"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 0,
            "y": 17
          },
          "id": 18,
          "options": {
            "barRadius": 0,
            "barWidth": 0.9,
            "colorByField": "cost",
            "fullHighlight": false,
            "groupWidth": 0.7,
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "orientation": "vertical",
            "showValue": "never",
            "stacking": "none",
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            },
            "xField": "line_item_availability_zone",
            "xTickLabelRotation": -45,
            "xTickLabelSpacing": 0
          },
          "pluginVersion": "9.4.7",
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  line_item_availability_zone,\n  SUM(line_item_unblended_cost) as cost\nFROM\n  $CurTable\nWHERE \n$__timeFilter(line_item_usage_start_date)\nAND line_item_product_code = 'AmazonEC2'\nAND resource_tags_user_$TagKey IN ($TagValue)\nAND line_item_operation = 'RunInstances'\nAND line_item_usage_type Like '%Usage%'\nGROUP BY \n1",
              "refId": "CUR AZ Query"
            }
          ],
          "title": "Compute Cost by AZ - Tag: $TagKey Value: $TagValue",
          "transparent": true,
          "type": "barchart"
        },
        {
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-RdYlGr"
              },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "",
                "axisPlacement": "auto",
                "fillOpacity": 30,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineWidth": 2,
                "scaleDistribution": {
                  "type": "linear"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "currencyUSD"
            },
            "overrides": []
          },
          "gridPos": {
            "h": 7,
            "w": 12,
            "x": 12,
            "y": 17
          },
          "id": 19,
          "options": {
            "barRadius": 0,
            "barWidth": 0.9,
            "colorByField": "cost",
            "fullHighlight": false,
            "groupWidth": 0.7,
            "legend": {
              "calcs": [],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "orientation": "vertical",
            "showValue": "never",
            "stacking": "none",
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            },
            "xField": "instance_type",
            "xTickLabelRotation": -45,
            "xTickLabelSpacing": 0
          },
          "pluginVersion": "9.4.7",
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  product_instance_type as instance_type,\n  SUM(line_item_unblended_cost) as cost\nFROM\n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type Like '%Usage%'\nGROUP BY \n1",
              "refId": "Instance Family Cost"
            }
          ],
          "title": "Compute Cost by Instance - Tag: $TagKey Value: $TagValue",
          "transparent": true,
          "type": "barchart"
        }
      ],
      "title": "Workload Cost Trends",
      "type": "row"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 19
      },
      "id": 11,
      "panels": [],
      "title": "Compute - Autoscaling Group: $ASGName",
      "type": "row"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Instances",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 30,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "none"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "CUR Compute Query"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "mode": "continuous-RdYlGr"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              },
              {
                "id": "custom.axisLabel",
                "value": "Compute Cost"
              },
              {
                "id": "custom.showPoints",
                "value": "always"
              },
              {
                "id": "displayName",
                "value": "Compute Cost"
              }
            ]
          },
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "GroupDesiredCapacity"
            },
            "properties": [
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 20
      },
      "id": 6,
      "links": [
        {
          "targetBlank": true,
          "title": "Cloudwatch",
          "url": "https://$Regions.console.aws.amazon.com/cloudwatch/home?region=$Regions#metricsV2?graph=~(view~'timeSeries~stacked~false~region~'us-east-1~start~'-PT168H~end~'P0D~metrics~(~(~'AWS*2fAutoScaling~'GroupDesiredCapacity~'AutoScalingGroupName~'$ASGName)~(~'.~'GroupTotalCapacity~'.~'.)))&query=~'*7bAWS*2fAutoScaling*2cAutoScalingGroupName*7d*20$ASGName"
        }
      ],
      "options": {
        "legend": {
          "calcs": [
            "max",
            "min"
          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena \nSELECT\n  date_trunc('$Granularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as Cost\nFROM $CurTable\nWHERE\n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type Like '%Usage%'\n  AND product_region = '$Regions' \n  --AND line_item_usage_account_id IN ($LinkedAccounts) --future use\n  --AND $CurTable .line_item_product_code in ($Services) --future use\nGROUP BY 1",
          "refId": "CUR Compute Query"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{AWS/AutoScaling,AutoScalingGroupName} MetricName=\"GroupTotalInstances\" \"$ASGName\"', 'Average', 300)",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "A",
          "region": "$Regions",
          "sqlExpression": "",
          "statistic": "Average"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{AWS/AutoScaling,AutoScalingGroupName} MetricName=\"GroupDesiredCapacity\" \"$ASGName\"', 'Average', 300)",
          "hide": false,
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "GroupDesiredCapacity",
          "region": "$Regions",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "Scaling Activity - ASG: $ASGName",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Instances",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 30,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "none"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "CUR Compute Query"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "mode": "continuous-GrYlRd"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              },
              {
                "id": "custom.axisLabel",
                "value": "Compute Cost"
              },
              {
                "id": "custom.showPoints",
                "value": "always"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 20
      },
      "id": 9,
      "links": [
        {
          "targetBlank": true,
          "title": "Cloudwatch",
          "url": "https://$Regions.console.aws.amazon.com/cloudwatch/home?region=$Regions#metricsV2?graph=~(view~'timeSeries~stacked~false~region~'us-east-1~start~'-PT168H~end~'P0D~metrics~(~(~'AWS*2fEC2~'CPUUtilization~'AutoScalingGroupName~'$ASGName)))&query=~'*7bAWS*2fEC2*2cAutoScalingGroupName*7d*20$ASGName"
        }
      ],
      "options": {
        "legend": {
          "calcs": [
            "max",
            "min"
          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena \nSELECT\n  date_trunc('$Granularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as cost\nfrom $CurTable\nWHERE\n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type Like '%Usage%'\n  AND product_region = '$Regions'\n  --AND line_item_usage_account_id IN ($LinkedAccounts) --future use\n  --AND $CurTable .line_item_product_code in ($Services) -- future use\nGROUP BY 1\nORDER BY 1",
          "refId": "CUR Compute Query"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "REMOVE_EMPTY(SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"CPUUtilization\" \"$ASGName\"', 'Average', 300))",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "CPUUtilization",
          "region": "$Regions",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "Average CPU - ASG: $ASGName",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "description": "Status failure Metrics for the entire ASG. This metric reports whether the instance has passed both the instance status check and the system status check in the last minute. This metric can be either 0 (passed) or 1 (failed). By default, this metric is available at a 1-minute frequency at no charge.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Failed Checks",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 30,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "none"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "CUR Compute Query"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "mode": "continuous-GrYlRd"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              },
              {
                "id": "custom.axisLabel",
                "value": "Compute Cost"
              },
              {
                "id": "custom.showPoints",
                "value": "always"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 28
      },
      "id": 20,
      "links": [
        {
          "targetBlank": true,
          "title": "Cloudwatch",
          "url": "https://$Regions.console.aws.amazon.com/cloudwatch/home?region=$Regions#metricsV2?graph=~(view~'timeSeries~stacked~false~region~'us-east-1~start~'-PT168H~end~'P0D~metrics~(~(~'AWS*2fEC2~'StatusCheckFailed~'AutoScalingGroupName~'$ASGName)))&query=~'*7bAWS*2fEC2*2cAutoScalingGroupName*7d*20$ASGName"
        }
      ],
      "options": {
        "legend": {
          "calcs": [
            "max",
            "min"
          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\n  date_trunc('$Granularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as cost\nfrom $CurTable\nWHERE\n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type Like '%Usage%'\n  AND product_region = '$Regions' \n  --AND line_item_usage_account_id IN ($LinkedAccounts)\n  --AND $CurTable .line_item_product_code in ($Services)\nGROUP BY 1\nORDER BY 1",
          "refId": "CUR Compute Query"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"StatusCheckFailed\" \"$ASGName\"', 'Average', 300)",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "StatusCheckFailed",
          "region": "$Regions",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "Instance Status Check Failed - ASG: $ASGName",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "description": "The number of earned CPU credits (T instances) that an instance(s) have accrued since they were launched or started for the named Auto Scaling Group. Credits are accrued in the credit balance after they are earned, and removed from the credit balance when they are spent. The credit balance has a maximum limit, determined by the instance size. ",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "CPU Credit",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 30,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "none"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "Compute Cost"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "mode": "continuous-GrYlRd"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "custom.axisLabel",
                "value": "Compute Cost"
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              },
              {
                "id": "custom.showPoints",
                "value": "always"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 28
      },
      "id": 21,
      "links": [
        {
          "targetBlank": true,
          "title": "Cloudwatch",
          "url": "https://$Regions.console.aws.amazon.com/cloudwatch/home?region=us-east-1#metricsV2?graph=~(view~'timeSeries~stacked~false~region~'$Regions~start~'-PT168H~end~'P0D~metrics~(~(~'AWS*2fEC2~'CPUCreditBalance~'AutoScalingGroupName~'$ASGName)~(~'.~'CPUCreditUsage~'.~'.)))&query=~'*7bAWS*2fEC2*2cAutoScalingGroupName*7d*20$ASGName"
        }
      ],
      "options": {
        "legend": {
          "calcs": [
            "max",
            "min"
          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\n  date_trunc('$Granularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as cost\nfrom $CurTable\nWHERE\n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type Like '%Usage%'\n  AND product_region = '$Regions' \n  --AND line_item_usage_account_id IN ($LinkedAccounts) -- future use\n  --AND $CurTable .line_item_product_code in ($Services) -- future use\nGROUP BY 1\nORDER BY 1",
          "refId": "Compute Cost"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"CPUCreditUsage\" \"$ASGName\"', 'Average', 300)",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "CPUCreditUsage",
          "region": "$Regions",
          "sqlExpression": "",
          "statistic": "Average"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"CPUCreditBalance\" \"$ASGName\"', 'Average', 300)",
          "hide": false,
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "CPUCreditBalance",
          "region": "$Regions",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "CPU Credit Balance - ASG: $ASGName",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 36
      },
      "id": 24,
      "panels": [
        {
          "datasource": {
            "type": "datasource",
            "uid": "-- Mixed --"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-BlPu"
              },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "MBytes",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 30,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineInterpolation": "smooth",
                "lineStyle": {
                  "dash": [
                    0,
                    10
                  ],
                  "fill": "dot"
                },
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "EC2 Compute Cost Query"
                },
                "properties": [
                  {
                    "id": "color",
                    "value": {
                      "mode": "continuous-GrYlRd"
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 0
                  },
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "EC2 Networking Cost"
                  },
                  {
                    "id": "displayName",
                    "value": "EC2 Networking Cost"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 21
          },
          "id": 22,
          "options": {
            "legend": {
              "calcs": [
                "max",
                "min"
              ],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            }
          },
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$Granularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as cost\nFROM\n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  -- AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type LIKE '%AWS%Bytes%'\n  AND product_region = '$Regions' \nGROUP BY \n1\nHAVING SUM(line_item_unblended_cost) > 0\n\n",
              "refId": "EC2 Compute Cost Query"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"NetworkOut\" \"$ASGName\"', 'Average', 300)",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "A",
              "region": "$Regions",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "EC2 Networking Bytes Out- ASG: $ASGName",
          "transparent": true,
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "datasource",
            "uid": "-- Mixed --"
          },
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-BlPu"
              },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "Packets",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 30,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineInterpolation": "smooth",
                "lineStyle": {
                  "dash": [
                    0,
                    10
                  ],
                  "fill": "dot"
                },
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "EC2 Compute Cost Query"
                },
                "properties": [
                  {
                    "id": "color",
                    "value": {
                      "mode": "continuous-GrYlRd"
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 0
                  },
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "EC2 Networking Cost"
                  },
                  {
                    "id": "displayName",
                    "value": "EC2 Networking Cost"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 21
          },
          "id": 41,
          "options": {
            "legend": {
              "calcs": [
                "max",
                "min"
              ],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            }
          },
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$Granularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as cost\nFROM\n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  -- AND line_item_operation = 'RunInstances'\n  AND line_item_usage_type LIKE '%AWS%Bytes%'\n  AND product_region = '$Regions' \nGROUP BY \n1\nHAVING SUM(line_item_unblended_cost) > 0\n\n",
              "refId": "EC2 Compute Cost Query"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"NetworkPacketsOut\" \"$ASGName\"', 'Average', 300)",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "A",
              "region": "$Regions",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "EC2 Networking Packets Out - ASG: $ASGName",
          "transparent": true,
          "type": "timeseries"
        }
      ],
      "title": "Network - Autoscaling Group: $ASGName",
      "type": "row"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 37
      },
      "id": 48,
      "panels": [],
      "title": "EBS Activity - $ASGName",
      "type": "row"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "MBytes",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 30,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "bytes"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "EBS Volume Cost"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "mode": "continuous-GrYlRd"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              },
              {
                "id": "custom.axisLabel",
                "value": "EBS Volume Cost"
              },
              {
                "id": "displayName",
                "value": "EBS Volume Cost"
              }
            ]
          },
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "EBSWriteBytes"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-purple",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 38
      },
      "id": 49,
      "options": {
        "legend": {
          "calcs": [
            "max",
            "min"
          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$Granularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as cost\nFROM\n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type Like '%VolumeUsage%'\n  AND product_region = '$Regions' \nGROUP BY \n1\nHAVING SUM(line_item_unblended_cost) > 0",
          "refId": "EBS Volume Cost"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"EBSReadBytes\" \"$ASGName\"', 'Average', 300)",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "EBSReadBytes",
          "region": "$Regions",
          "sqlExpression": "",
          "statistic": "Average"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"EBSWriteBytes\" \"$ASGName\"', 'Average', 300)",
          "hide": false,
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "EBSWriteBytes",
          "region": "$Regions",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "EBS Volume Read/Write- ASG: $ASGName",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "datasource",
        "uid": "-- Mixed --"
      },
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "continuous-BlPu"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "MBytes",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 30,
            "gradientMode": "scheme",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "lineInterpolation": "smooth",
            "lineStyle": {
              "dash": [
                0,
                10
              ],
              "fill": "dot"
            },
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "bytes"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "EBS Volume Cost"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "mode": "continuous-GrYlRd"
                }
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "unit",
                "value": "currencyUSD"
              },
              {
                "id": "custom.axisLabel",
                "value": "EBS Volume Cost"
              },
              {
                "id": "displayName",
                "value": "EBS Volume Cost"
              }
            ]
          },
          {
            "matcher": {
              "id": "byFrameRefID",
              "options": "EBSWriteBytes"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "dark-purple",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 38
      },
      "id": 50,
      "options": {
        "legend": {
          "calcs": [
            "max",
            "min"
          ],
          "displayMode": "list",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "targets": [
        {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "datasource": {
            "type": "grafana-athena-datasource",
            "uid": "${DS_COAST-2023-09-19}"
          },
          "format": 1,
          "hide": false,
          "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT \n  date_trunc('$Granularity', line_item_usage_start_date),\n  SUM(line_item_unblended_cost) as cost\nFROM\n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date)\n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type Like '%VolumeUsage%'\n  AND product_region = '$Regions' \nGROUP BY \n1\nHAVING SUM(line_item_unblended_cost) > 0",
          "refId": "EBS Volume Cost"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"EBSReadOps\" \"$ASGName\"', 'Average', 300)",
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "EBSReadIO",
          "region": "$Regions",
          "sqlExpression": "",
          "statistic": "Average"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "dimensions": {},
          "expression": "SEARCH('{\"AWS/EC2\",\"AutoScalingGroupName\"} MetricName=\"EBSWriteOps\" \"$ASGName\"', 'Average', 300)",
          "hide": false,
          "id": "",
          "label": "",
          "logGroups": [],
          "matchExact": true,
          "metricEditorMode": 1,
          "metricName": "",
          "metricQueryType": 0,
          "namespace": "",
          "period": "",
          "queryMode": "Metrics",
          "refId": "EBSWriteIO",
          "region": "$Regions",
          "sqlExpression": "",
          "statistic": "Average"
        }
      ],
      "title": "EBS Volume Read/Write IOPS ASG: $ASGName",
      "transparent": true,
      "type": "timeseries"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 46
      },
      "id": 38,
      "panels": [
        {
          "datasource": {
            "type": "datasource",
            "uid": "-- Mixed --"
          },
          "description": "Load Balancer LCU Usage for $LBName - Be sure to update the Load Balancer Name variable at the top of the dashboard.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-BlPu"
              },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "MBytes",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 30,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineInterpolation": "smooth",
                "lineStyle": {
                  "dash": [
                    0,
                    10
                  ],
                  "fill": "dot"
                },
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "LCUUsage"
                },
                "properties": [
                  {
                    "id": "color",
                    "value": {
                      "mode": "continuous-GrYlRd"
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 0
                  },
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "ELB Networking Cost"
                  },
                  {
                    "id": "displayName",
                    "value": "ELB Networking Cost"
                  },
                  {
                    "id": "custom.showPoints",
                    "value": "always"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 23
          },
          "id": 40,
          "links": [
            {
              "targetBlank": true,
              "title": "ELB Pricing Page",
              "url": "https://aws.amazon.com/elasticloadbalancing/pricing/"
            }
          ],
          "options": {
            "legend": {
              "calcs": [
                "max",
                "min"
              ],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            }
          },
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\ndate_trunc('$Granularity', line_item_usage_start_date),\nSUM(line_item_unblended_cost) as cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AWSELB'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND (line_item_usage_type LIKE '%LCUUsage' OR line_item_usage_type LIKE '%NLCUUsage')\n  AND line_item_operation LIKE '%LoadBalancing%'\n  AND line_item_resource_id LIKE CONCAT('%', '$LBName')\n  AND product_region = '$Regions' \n  GROUP BY\n  1\n  HAVING SUM(line_item_unblended_cost) > 0 \n",
              "refId": "LCUUsage"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "SEARCH('{\"AWS/ApplicationELB\",\"LoadBalancer\"} MetricName=\"ConsumedLCUs\" \"$LBName\"', 'Average', 300)",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "ConsumedLCUs",
              "region": "$Regions",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "LCU Metrics  - ELB: $LBName",
          "transformations": [],
          "transparent": true,
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "datasource",
            "uid": "-- Mixed --"
          },
          "description": "Load Balancer LCU Usage for ELB $LBName - Be sure to update the Load Balancer Name variable at the top of the dashboard.",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-BlPu"
              },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "MBytes",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 30,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineInterpolation": "smooth",
                "lineStyle": {
                  "dash": [
                    0,
                    10
                  ],
                  "fill": "dot"
                },
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "LCUUsage"
                },
                "properties": [
                  {
                    "id": "color",
                    "value": {
                      "mode": "continuous-GrYlRd"
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 0
                  },
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "ELB Hourly Cost"
                  },
                  {
                    "id": "displayName",
                    "value": "ELB Hourly Cost"
                  },
                  {
                    "id": "custom.showPoints",
                    "value": "always"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 23
          },
          "id": 39,
          "links": [
            {
              "targetBlank": true,
              "title": "ELB Pricing Page",
              "url": "https://aws.amazon.com/elasticloadbalancing/pricing/"
            }
          ],
          "options": {
            "legend": {
              "calcs": [
                "max",
                "min"
              ],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            }
          },
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\ndate_trunc('$Granularity', line_item_usage_start_date),\nSUM(line_item_unblended_cost) as cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AWSELB'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type LIKE '%LoadBalancerUsage' \n  AND line_item_operation LIKE '%LoadBalancing%'\n  AND line_item_resource_id LIKE CONCAT('%', '$LBName')\n  AND product_region = '$Regions' \n  GROUP BY\n  1\n  HAVING SUM(line_item_unblended_cost) > 0 \n",
              "refId": "LCUUsage"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "SEARCH('{\"AWS/ApplicationELB\",\"LoadBalancer\"} MetricName=\"ConsumedLCUs\" \"$LBName\"', 'Average', 300)",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "ConsumedLCUs",
              "region": "$Regions",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "Hourly Cost and Requests  - ELB: $LBName",
          "transformations": [],
          "transparent": true,
          "type": "timeseries"
        }
      ],
      "repeat": "LBName",
      "repeatDirection": "h",
      "title": "ELB Networking - TagValue: $TagValue - LBName: $LBName",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 47
      },
      "id": 53,
      "panels": [
        {
          "datasource": {
            "type": "datasource",
            "uid": "-- Mixed --"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-BlPu"
              },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "MBytes",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 30,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineInterpolation": "smooth",
                "lineStyle": {
                  "dash": [
                    0,
                    10
                  ],
                  "fill": "dot"
                },
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "NGWTraffic"
                },
                "properties": [
                  {
                    "id": "color",
                    "value": {
                      "mode": "continuous-GrYlRd"
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 0
                  },
                  {
                    "id": "displayName",
                    "value": "Nat Gateway Traffic Cost"
                  },
                  {
                    "id": "custom.showPoints",
                    "value": "always"
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "Traffic Cost"
                  },
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 24
          },
          "id": 51,
          "links": [
            {
              "targetBlank": true,
              "title": "ELB Pricing Page",
              "url": "https://aws.amazon.com/elasticloadbalancing/pricing/"
            }
          ],
          "options": {
            "legend": {
              "calcs": [
                "max",
                "min"
              ],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            }
          },
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\ndate_trunc('$Granularity', line_item_usage_start_date),\nSUM(line_item_unblended_cost) as cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type = 'NatGateway-Bytes'\n  AND line_item_operation = 'NatGateway'\n  AND line_item_resource_id LIKE CONCAT('%', '$NGWName')\n  AND product_region = '$Regions' \n  GROUP BY\n  1\n",
              "refId": "NGWTraffic"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "SEARCH('{\"AWS/NATGateway\",\"NatGatewayId\"} MetricName=\"BytesOutToDestination\" \"$NGWName\"', 'Average', 300)",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "BytesOutToDestination",
              "region": "$Regions",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "NatGateway Traffic Cost",
          "transformations": [],
          "transparent": true,
          "type": "timeseries"
        },
        {
          "datasource": {
            "type": "datasource",
            "uid": "-- Mixed --"
          },
          "description": "",
          "fieldConfig": {
            "defaults": {
              "color": {
                "mode": "continuous-BlPu"
              },
              "custom": {
                "axisCenteredZero": false,
                "axisColorMode": "text",
                "axisLabel": "MBytes",
                "axisPlacement": "auto",
                "barAlignment": 0,
                "drawStyle": "line",
                "fillOpacity": 30,
                "gradientMode": "scheme",
                "hideFrom": {
                  "legend": false,
                  "tooltip": false,
                  "viz": false
                },
                "lineInterpolation": "smooth",
                "lineStyle": {
                  "dash": [
                    0,
                    10
                  ],
                  "fill": "dot"
                },
                "lineWidth": 2,
                "pointSize": 5,
                "scaleDistribution": {
                  "type": "linear"
                },
                "showPoints": "auto",
                "spanNulls": false,
                "stacking": {
                  "group": "A",
                  "mode": "none"
                },
                "thresholdsStyle": {
                  "mode": "off"
                }
              },
              "mappings": [],
              "thresholds": {
                "mode": "absolute",
                "steps": [
                  {
                    "color": "green"
                  },
                  {
                    "color": "red",
                    "value": 80
                  }
                ]
              },
              "unit": "none"
            },
            "overrides": [
              {
                "matcher": {
                  "id": "byFrameRefID",
                  "options": "NGWHourly"
                },
                "properties": [
                  {
                    "id": "color",
                    "value": {
                      "fixedColor": "yellow",
                      "mode": "fixed"
                    }
                  },
                  {
                    "id": "custom.fillOpacity",
                    "value": 0
                  },
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  },
                  {
                    "id": "displayName",
                    "value": "NatGateway Hourly Cost"
                  },
                  {
                    "id": "custom.showPoints",
                    "value": "always"
                  },
                  {
                    "id": "unit",
                    "value": "currencyUSD"
                  },
                  {
                    "id": "custom.axisLabel",
                    "value": "NatGateway Hourly Cost"
                  }
                ]
              }
            ]
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 12,
            "y": 24
          },
          "id": 54,
          "links": [
            {
              "targetBlank": true,
              "title": "ELB Pricing Page",
              "url": "https://aws.amazon.com/elasticloadbalancing/pricing/"
            }
          ],
          "options": {
            "legend": {
              "calcs": [
                "max",
                "min"
              ],
              "displayMode": "list",
              "placement": "bottom",
              "showLegend": true
            },
            "tooltip": {
              "mode": "multi",
              "sort": "none"
            }
          },
          "targets": [
            {
              "connectionArgs": {
                "catalog": "__default",
                "database": "__default",
                "region": "__default",
                "resultReuseEnabled": false,
                "resultReuseMaxAgeInMinutes": 60
              },
              "datasource": {
                "type": "grafana-athena-datasource",
                "uid": "${DS_COAST-2023-09-19}"
              },
              "format": 1,
              "hide": false,
              "rawSQL": "-- When troubleshooting a query, it helps to use the Query Inspector button and copy the query into Athena\n-- To view resource names add in line_item_resource_id to the SELECT and GROUP BY statements\nSELECT\ndate_trunc('$Granularity', line_item_usage_start_date),\nSUM(line_item_unblended_cost) as cost\nFROM \n  $CurTable\nWHERE \n  $__timeFilter(line_item_usage_start_date) \n  AND line_item_product_code = 'AmazonEC2'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n  AND line_item_usage_type = 'NatGateway-Hours'\n  AND line_item_operation = 'NatGateway'\n  AND line_item_resource_id LIKE CONCAT('%', '$NGWName')\n  AND product_region = '$Regions' \n  GROUP BY\n  1\n",
              "refId": "NGWHourly"
            },
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "SEARCH('{\"AWS/NATGateway\",\"NatGatewayId\"} MetricName=\"BytesOutToDestination\" \"$NGWName\"', 'Average', 300)",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 1,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "BytesOutToDestination",
              "region": "$Regions",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "NatGateway Test",
          "transformations": [],
          "transparent": true,
          "type": "timeseries"
        }
      ],
      "repeat": "NGWName",
      "repeatDirection": "h",
      "title": "NatGateway - TagValue: $TagValue - NGWName - $NGWName",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 48
      },
      "id": 83,
      "panels": [
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "gridPos": {
            "h": 9,
            "w": 24,
            "x": 0,
            "y": 25
          },
          "id": 71,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "ASG Name: <span style='color: #AF69EE'>$ASGName</span><br>\nTag Key: <span style='color: #FF9900'>$TagKey</span><br>\nTag Value: <span style='color: #FF9900'>$TagValue</span>\n<br><br>\n\n\n<strong>Scaling Activity</strong>- Graphs Cloudwatch GroupDesiredCapacity and GroupTotalInstances over the total instance compute cost for instances \ntagged with $TagKey:$TagValue.<br>\n<strong>Average CPU</strong>- Graphs Cloudwatch Total ASG CPUUtilization over the total instance compute cost for instances \ntagged with $TagKey:$TagValue.<br>\n<strong>Instance Status Check Failed</strong>- Graphs Cloudwatch Total ASG CPUUtilization over the total instance compute cost for instances \ntagged with $TagKey:$TagValue. See <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/monitoring-system-instance-status-check.html\">Instance Status Checks</a><br>\n<strong>CPU Credit Balance</strong>- Graphs Cloudwatch CPUCreditUsage and CPUCreditBalance for the ASG over the total instance compute cost for instances \ntagged with $TagKey:$TagValue.<br>  See <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/burstable-performance-instances-monitoring-cpu-credits.html\">Burstable CPU Credits.</a>\n\n<br><span style=\"color:lightblue\">The link at the top of each graph will open up Cloudwatch metrics for each scenario. </span>",
            "mode": "markdown"
          },
          "pluginVersion": "9.4.7",
          "targets": [
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "A",
              "region": "$Regions",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "Auto Scaling Compute Metrics",
          "type": "text"
        },
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "gridPos": {
            "h": 7,
            "w": 24,
            "x": 0,
            "y": 34
          },
          "id": 81,
          "options": {
            "code": {
              "language": "plaintext",
              "showLineNumbers": false,
              "showMiniMap": false
            },
            "content": "ASG Name: <span style='color: #AF69EE'>$ASGName</span><br>\nTag Key: <span style='color: #FF9900'>$TagKey</span><br>\nTag Value: <span style='color: #FF9900'>$TagValue</span>\n<br><br>\n\n\n<strong>Scaling Activity</strong>- Graphs Cloudwatch NetworkOut for the ASG over the total cost of networking for all resources\ntagged with $TagKey:$TagValue.<br>\n<strong>Average CPU</strong>- Graphs Cloudwatch NetworkPacketsOut for the ASG over the total cost of networking for all resources\ntagged with $TagKey:$TagValue.<br>\n\n<br><span style=\"color:lightblue\">The link at the top of each graph will open up Cloudwatch metrics for each scenario. </span>",
            "mode": "markdown"
          },
          "pluginVersion": "9.4.7",
          "targets": [
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "A",
              "region": "$Regions",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "Auto Scaling Group Networking Metrics",
          "type": "text"
        }
      ],
      "title": "Dashboard Index",
      "type": "row"
    },
    {
      "collapsed": true,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 49
      },
      "id": 90,
      "panels": [
        {
          "datasource": {
            "type": "cloudwatch",
            "uid": "${DS_CLOUDWATCH}"
          },
          "gridPos": {
            "h": 8,
            "w": 12,
            "x": 0,
            "y": 26
          },
          "id": 88,
          "options": {
            "limit": 10,
            "navigateAfter": "360m",
            "navigateBefore": "2880m",
            "navigateToPanel": true,
            "onlyFromThisDashboard": false,
            "onlyInTimeRange": false,
            "showTags": true,
            "showTime": true,
            "showUser": true
          },
          "targets": [
            {
              "datasource": {
                "type": "cloudwatch",
                "uid": "${DS_CLOUDWATCH}"
              },
              "dimensions": {},
              "expression": "",
              "id": "",
              "label": "",
              "logGroups": [],
              "matchExact": true,
              "metricEditorMode": 0,
              "metricName": "",
              "metricQueryType": 0,
              "namespace": "",
              "period": "",
              "queryMode": "Metrics",
              "refId": "A",
              "region": "$Regions",
              "sqlExpression": "",
              "statistic": "Average"
            }
          ],
          "title": "Annotations",
          "type": "annolist"
        }
      ],
      "title": "Annotations",
      "type": "row"
    }
  ],
  "refresh": "",
  "revision": 1,
  "schemaVersion": 38,
  "style": "dark",
  "tags": [],
  "templating": {
    "list": [
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_COAST-2023-09-19}"
        },
        "definition": "",
        "description": "Return all regions within the CUR ",
        "hide": 0,
        "includeAll": false,
        "label": "Regions",
        "multi": false,
        "name": "Regions",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "SELECT DISTINCT(product_region) from $CurTable;"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 1,
        "type": "query"
      },
      {
        "current": {
          "selected": false,
          "text": "",
          "value": ""
        },
        "description": "Input the name of your autoscaling group",
        "hide": 0,
        "label": "ASG Name",
        "name": "ASGName",
        "options": [
          {
            "selected": true,
            "text": "",
            "value": ""
          }
        ],
        "query": "",
        "skipUrlSync": false,
        "type": "textbox"
      },
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_COAST-2023-09-19}"
        },
        "definition": "",
        "description": "Load Balancer Name - tagged with $TagKey $TagValue - Look back period of 3 Days.",
        "hide": 0,
        "includeAll": false,
        "label": "Load Balancer",
        "multi": true,
        "name": "LBName",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "SELECT \n  DISTINCT(line_item_resource_id)\nFROM\n  $CurTable\nWHERE \n  line_item_usage_start_date >= (current_date - interval '3' day) --lookback period\n  AND line_item_product_code = 'AWSELB'\n  AND resource_tags_user_$TagKey IN ($TagValue)\n"
        },
        "refresh": 1,
        "regex": "/.*loadbalancer\\/([^]*).*/",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_COAST-2023-09-19}"
        },
        "definition": "",
        "description": "Select the Nat Gateways for this workload tagged with $TagKey $TagValue - Look back period of 3 Days",
        "hide": 0,
        "includeAll": false,
        "label": "NatGatway",
        "multi": true,
        "name": "NGWName",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "SELECT \nDISTINCT line_item_resource_id\nFROM\n$CurTable\nWHERE \nline_item_usage_start_date >= (current_date - interval '3' day) --lookback period\nAND line_item_product_code = 'AmazonEC2'\nAND resource_tags_user_$TagKey IN ($TagValue)\nAND line_item_usage_type LIKE 'NatGateway-%'\nAND line_item_operation = 'NatGateway'\n"
        },
        "refresh": 1,
        "regex": "/.*natgateway\\/([^]*).*/",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_COAST-2023-09-19}"
        },
        "definition": "",
        "hide": 0,
        "includeAll": false,
        "label": "Tag Key",
        "multi": false,
        "name": "TagKey",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "SHOW COLUMNS FROM $CurTable;"
        },
        "refresh": 1,
        "regex": "/resource_tags_user_(.+)/",
        "skipUrlSync": false,
        "sort": 1,
        "type": "query"
      },
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_COAST-2023-09-19}"
        },
        "definition": "",
        "hide": 0,
        "includeAll": true,
        "label": "Tag Value",
        "multi": true,
        "name": "TagValue",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "SELECT DISTINCT(resource_tags_user_$TagKey) FROM $CurTable WHERE resource_tags_user_$TagKey IS NOT NULL AND NOT resource_tags_user_$TagKey = '';"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 1,
        "type": "query"
      },
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_COAST-2023-09-19}"
        },
        "definition": "",
        "hide": 2,
        "includeAll": false,
        "label": "Cur Table",
        "multi": false,
        "name": "CurTable",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "show tables"
        },
        "refresh": 1,
        "regex": "^(?!cost_and_usage_data_status|coastflowlogs).+$",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      },
      {
        "current": {
          "selected": false,
          "text": "COAST-2023-09-19",
          "value": "COAST-2023-09-19"
        },
        "hide": 2,
        "includeAll": false,
        "label": "",
        "multi": false,
        "name": "CurDataSource",
        "options": [],
        "query": "grafana-athena-datasource",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "type": "datasource"
      },
      {
        "current": {},
        "datasource": {
          "type": "grafana-athena-datasource",
          "uid": "${DS_COAST-2023-09-19}"
        },
        "definition": "",
        "description": "Linked accounts pulled from CUR",
        "hide": 2,
        "includeAll": true,
        "label": "Linked Accounts",
        "multi": true,
        "name": "LinkedAccounts",
        "options": [],
        "query": {
          "connectionArgs": {
            "catalog": "__default",
            "database": "__default",
            "region": "__default",
            "resultReuseEnabled": false,
            "resultReuseMaxAgeInMinutes": 60
          },
          "format": 1,
          "rawSQL": "SELECT DISTINCT(line_item_usage_account_id) FROM $CurTable;"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 3,
        "type": "query"
      },
      {
        "current": {
          "selected": false,
          "text": "hour",
          "value": "hour"
        },
        "hide": 0,
        "includeAll": false,
        "label": "Granularity",
        "multi": false,
        "name": "Granularity",
        "options": [
          {
            "selected": false,
            "text": "month",
            "value": "month"
          },
          {
            "selected": false,
            "text": "week",
            "value": "week"
          },
          {
            "selected": false,
            "text": "day",
            "value": "day"
          },
          {
            "selected": true,
            "text": "hour",
            "value": "hour"
          }
        ],
        "query": "month,week,day,hour",
        "queryValue": "",
        "skipUrlSync": false,
        "type": "custom"
      },
      {
        "current": {
          "selected": false,
          "text": "Cloudwatch",
          "value": "Cloudwatch"
        },
        "hide": 2,
        "includeAll": false,
        "label": "Cloudwatch Data Source",
        "multi": false,
        "name": "CloudwatchDataSource",
        "options": [],
        "query": "cloudwatch",
        "queryValue": "",
        "refresh": 1,
        "regex": "/^Cloud/",
        "skipUrlSync": false,
        "type": "datasource"
      },
      {
        "current": {},
        "datasource": {
          "type": "cloudwatch",
          "uid": "${DS_CLOUDWATCH}"
        },
        "definition": "",
        "hide": 2,
        "includeAll": false,
        "label": "EC2 Cloudwatch Metrics",
        "multi": false,
        "name": "EC2CloudwatchMetrics",
        "options": [],
        "query": {
          "namespace": "AWS/EC2",
          "queryType": "metrics",
          "refId": "CloudWatchVariableQueryEditor-VariableQuery",
          "region": "$Regions"
        },
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 1,
        "type": "query"
      },
      {
        "current": {
          "selected": false,
          "text": "COAST-2023-09-19",
          "value": "COAST-2023-09-19"
        },
        "hide": 2,
        "includeAll": false,
        "multi": false,
        "name": "Datasource",
        "options": [],
        "query": "grafana-athena-datasource",
        "refresh": 1,
        "regex": "/^COAST/",
        "skipUrlSync": false,
        "type": "datasource"
      }
    ]
  },
  "time": {
    "from": "now-2d",
    "to": "now"
  },
  "timepicker": {},
  "timezone": "",
  "title": "Autoscaling Dashboard2",
  "uid": "G9CQ3OpIzfda2",
  "version": 3,
  "weekStart": ""
}